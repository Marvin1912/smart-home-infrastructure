{{ range $path, $file := .Files.Glob "dashboards/*.json" }}
{{ $rawfile := $.Files.Get $path }}
{{ $dashboard := fromJson $rawfile }}
---
apiVersion: grafana.integreatly.org/v1beta1
kind: GrafanaDashboard
metadata:
  name: {{ $dashboard.title | lower }}-dashboard
  labels:
    app: grafana
spec:
  resyncPeriod: {{ $.Values.resyncPeriod }}
  instanceSelector:
    matchLabels:
      app: "grafana"
  json: |
{{ $rawfile | indent 4 }}
{{ end }}
